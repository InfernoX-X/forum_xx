<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= post.title %> | <%= siteTitle %></title>
    <link rel="icon" href="<%= favIcon %>">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
    :root {
        --accent: #F93742;
        --accent-hover: #ff4d57;
        --bg: #0f0f0f; 
        --surface: #1a1a1a;
        --border: #2b2b2b;
        --text-main: #f1f1f1;
        --text-muted: #aaaaaa;
        --radius: 16px;
    }
    /* Scrollbar */
    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: var(--bg); }
    ::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }

    body { 
        background-color: var(--bg); 
        color: var(--text-main); 
        font-family: 'Inter', sans-serif; 
        margin: 0;
        -webkit-font-smoothing: antialiased;
    }

    .main-wrapper {
        max-width: 800px;
        margin: 0 auto;
        padding: 24px;
    }

    /* Back Button Styling */
    .nav-header { margin-bottom: 20px; }
    .back-btn {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        color: var(--text-muted);
        text-decoration: none;
        font-weight: 500;
        transition: color 0.2s;
    }
    .back-btn:hover { color: var(--text-main); }

    /* Hero/Media Section */
    .post-hero-wrapper {
        width: 100%;
        background: #000;
        border-radius: var(--radius);
        overflow: hidden;
        border: 1px solid var(--border);
        margin-bottom: 24px;
        box-shadow: 0 20px 40px rgba(0,0,0,0.4);
    }
    .post-hero-image {
        width: 100%;
        max-height: max-content;
        object-fit: contain;
        display: block;
    }

    /* Title & Action Section */
    .post-header { margin-bottom: 20px; }
    .post-header h1 {
        font-size: 2rem;
        font-weight: 700;
        margin-bottom: 12px;
        line-height: 1.3;
    }

    /* Author/Channel Bar */
    .author-bar {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding-bottom: 20px;
        margin-bottom: 20px;
        border-bottom: 1px solid var(--border);
    }
    .author-info { display: flex; align-items: center; gap: 12px; }
    .avatar-circle {
        width: 40px; height: 40px;
        background: linear-gradient(45deg, #333, #555);
        border-radius: 50%;
        display: flex; align-items: center; justify-content: center;
        font-weight: 700; color: white;
    }
    .author-details div { font-weight: 600; font-size: 1rem; }
    .author-details span { color: var(--text-muted); font-size: 0.85rem; }

    /* Content Area */
    .description-card {
        background: var(--surface);
        padding: 20px;
        border-radius: 12px;
        margin-bottom: 40px;
    }
    .description-card:hover { background: #252525; }
    
    .tags-row { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 16px; }
    .forum-badge {
        background: var(--accent);
        color: #fff;
        font-size: 0.75rem;
        padding: 4px 10px;
        border-radius: 6px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .post-content {
        font-size: 1.05rem;
        line-height: 1.6;
        color: #eee;
    }

    /* External Link Styling */
    .link-footer {
        display: flex;
        align-items: center;
        gap: 12px;
        background: rgba(74, 144, 226, 0.1);
        padding: 16px;
        border-radius: 12px;
        border: 1px dashed #4A90E2;
    }
    .link-footer a {
        color: #4A90E2;
        text-decoration: none;
        font-weight: 600;
        word-break: break-all;
    }
    .link-footer a:hover { text-decoration: underline; }

</style>

<body>
<%- include("../partials/navBar") %>

<div class="main-wrapper">
    <div class="nav-header">
        <a href="/" class="back-btn">‚Üê Back to Feed</a>
    </div>

    <% if (post.image) { %>
        <div id="posts-feed"> 
            <div class="post-hero-wrapper popUpClass">
                <img src="<%= post.image %>" loading="lazy" class="post-hero-image" alt="Post Image" style="cursor: pointer;">
            </div>
        </div>
    <% } %>

    <div class="post-header">
        <h1><%= post.title %></h1>
        
        <div class="author-bar">
            <div class="author-info">
                <div class="author-details">
                    <div style="color: var(--accent);"><%= post.username %></div>
                    <span><%= timeAgo(post.created_at) %></span>
                </div>
            </div>
            
        </div>
    </div>

    <div class="description-card">
        <div class="tags-row">
            <% if (post.categories) { %>
                <% post.categories.split(',').forEach(cat => { %>
                    <span class="forum-badge"><%= cat %></span>
                <% }) %>
            <% } %>
        </div>
        
        <p class="post-content">
            Description: <%= post.content %>
        </p>

        <% if(post.url) { %>
            <div style="margin-top: 30px;">
                <div class="link-footer">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#4A90E2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg>
                    <a href="<%= post.url %>" target="_blank"><%= post.url %></a>
                </div>
            </div>
        <% } %>
    </div>
</div>

<%- include("../partials/imageViewer") %>

<script>
    if (typeof initializeImageGallery === "function") {
        initializeImageGallery("popUpClass");
    }
</script>
</body>
</html>